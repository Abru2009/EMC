<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Equations Solver and Consistency Checker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .calculator {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        .formula {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f0f8ff;
            border-radius: 5px;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .input-section {
            flex: 1;
            min-width: 300px;
        }
        .input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .equation-input {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .coefficient {
            width: 60px;
            margin: 0 5px;
        }
        .method-selector {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #4a7aff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3a5eda;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f9ff;
            border-radius: 5px;
            display: none;
        }
        .steps {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            display: none;
        }
        .steps-btn {
            background: none;
            color: #4a7aff;
            border: none;
            padding: 5px 0;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
            width: auto;
            text-align: left;
        }
        .graph-container {
            flex: 1;
            min-width: 300px;
            margin-top: 20px;
        }
        #graph {
            width: 100%;
            height: 300px;
            border: 1px solid #ddd;
            background-color: #f8f8f8;
            position: relative;
            overflow: hidden;
        }
        .grid-line {
            stroke: #e0e0e0;
            stroke-width: 1;
        }
        .axis-line {
            stroke: #999;
            stroke-width: 2;
        }
        .axis-label {
            font-size: 12px;
            fill: #666;
        }
        .line1 {
            stroke: #ff6b6b;
            stroke-width: 2;
        }
        .line2 {
            stroke: #4ecdc4;
            stroke-width: 2;
        }
        .intersection {
            fill: #4a7aff;
            stroke: #333;
            stroke-width: 1;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #eee;
            border: 1px solid #ddd;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
        }
        .tab.active {
            background-color: white;
            border-bottom: 1px solid white;
        }
        .consistency-indicator {
            display: flex;
            align-items: center;
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .consistent {
            background-color: #d4edda;
            color: #155724;
        }
        .inconsistent {
            background-color: #f8d7da;
            color: #721c24;
        }
        .dependent {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .ratio-row {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>Linear Equations Solver and Consistency Checker</h1>
        
        <div class="formula">
            <p>Solve and check the consistency of a system of linear equations:</p>
            <p><strong>a₁x + b₁y = c₁</strong></p>
            <p><strong>a₂x + b₂y = c₂</strong></p>
        </div>
        
        <div class="tabs">
            <div class="tab active" id="algebraicTab">Algebraic Methods</div>
            <div class="tab" id="graphicalTab">Graphical Method</div>
            <div class="tab" id="consistencyTab">Consistency Check</div>
        </div>
        
        <div id="algebraicContent">
            <div class="container">
                <div class="input-section">
                    <h3>Enter Linear Equations</h3>
                    <div class="input-group">
                        <div class="equation-input">
                            <input type="number" id="a1" class="coefficient" value="2" step="any"> x +
                            <input type="number" id="b1" class="coefficient" value="3" step="any"> y =
                            <input type="number" id="c1" class="coefficient" value="8" step="any">
                        </div>
                        <div class="equation-input">
                            <input type="number" id="a2" class="coefficient" value="1" step="any"> x +
                            <input type="number" id="b2" class="coefficient" value="-1" step="any"> y =
                            <input type="number" id="c2" class="coefficient" value="1" step="any">
                        </div>
                    </div>
                    
                    <div class="method-selector">
                        <label for="method">Select Solution Method:</label>
                        <select id="method">
                            <option value="substitution">Substitution Method</option>
                            <option value="elimination">Elimination Method</option>
                        </select>
                    </div>
                    
                    <button id="calculateAlgebraic">Solve System</button>
                    
                    <div id="algebraicResult">
                        <h3>Result:</h3>
                        <p id="solution"></p>
                        
                        <button class="steps-btn" id="toggleAlgebraicSteps">Show Steps</button>
                        <div class="steps" id="algebraicSteps"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="graphicalContent" style="display: none;">
            <div class="container">
                <div class="input-section">
                    <h3>Enter Linear Equations</h3>
                    <div class="input-group">
                        <div class="equation-input">
                            <input type="number" id="g_a1" class="coefficient" value="2" step="any"> x +
                            <input type="number" id="g_b1" class="coefficient" value="3" step="any"> y =
                            <input type="number" id="g_c1" class="coefficient" value="8" step="any">
                        </div>
                        <div class="equation-input">
                            <input type="number" id="g_a2" class="coefficient" value="1" step="any"> x +
                            <input type="number" id="g_b2" class="coefficient" value="-1" step="any"> y =
                            <input type="number" id="g_c2" class="coefficient" value="1" step="any">
                        </div>
                    </div>
                    
                    <button id="calculateGraphical">Graph and Solve</button>
                    
                    <div id="graphicalResult">
                        <h3>Result:</h3>
                        <p id="graphSolution"></p>
                    </div>
                </div>
                
                <div class="graph-container">
                    <h3>Graph Visualization</h3>
                    <svg id="graph" width="400" height="300"></svg>
                </div>
            </div>
        </div>
        
        <div id="consistencyContent" style="display: none;">
            <div class="container">
                <div class="input-section">
                    <h3>Enter Linear Equations</h3>
                    <div class="input-group">
                        <div class="equation-input">
                            <input type="number" id="c_a1" class="coefficient" value="2" step="any"> x +
                            <input type="number" id="c_b1" class="coefficient" value="3" step="any"> y =
                            <input type="number" id="c_c1" class="coefficient" value="8" step="any">
                        </div>
                        <div class="equation-input">
                            <input type="number" id="c_a2" class="coefficient" value="4" step="any"> x +
                            <input type="number" id="c_b2" class="coefficient" value="6" step="any"> y =
                            <input type="number" id="c_c2" class="coefficient" value="16" step="any">
                        </div>
                    </div>
                    
                    <button id="checkConsistency">Check Consistency</button>
                    
                    <div id="consistencyResult">
                        <h3>Analysis:</h3>
                        <div id="consistencyIndicator" class="consistency-indicator">
                            <span class="status-icon">●</span>
                            <span id="consistencyStatus">Checking...</span>
                        </div>
                        
                        <div id="ratioAnalysis"></div>
                        
                        <button class="steps-btn" id="toggleConsistencySteps">Show Steps</button>
                        <div class="steps" id="consistencySteps"></div>
                    </div>
                </div>
                
                <div class="graph-container">
                    <h3>Graph Visualization</h3>
                    <svg id="consistencyGraph" width="400" height="300"></svg>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.getElementById('algebraicTab').addEventListener('click', function() {
            document.getElementById('algebraicTab').classList.add('active');
            document.getElementById('graphicalTab').classList.remove('active');
            document.getElementById('consistencyTab').classList.remove('active');
            document.getElementById('algebraicContent').style.display = 'block';
            document.getElementById('graphicalContent').style.display = 'none';
            document.getElementById('consistencyContent').style.display = 'none';
        });
        
        document.getElementById('graphicalTab').addEventListener('click', function() {
            document.getElementById('graphicalTab').classList.add('active');
            document.getElementById('algebraicTab').classList.remove('active');
            document.getElementById('consistencyTab').classList.remove('active');
            document.getElementById('graphicalContent').style.display = 'block';
            document.getElementById('algebraicContent').style.display = 'none';
            document.getElementById('consistencyContent').style.display = 'none';
            updateGraph();
        });
        
        document.getElementById('consistencyTab').addEventListener('click', function() {
            document.getElementById('consistencyTab').classList.add('active');
            document.getElementById('algebraicTab').classList.remove('active');
            document.getElementById('graphicalTab').classList.remove('active');
            document.getElementById('consistencyContent').style.display = 'block';
            document.getElementById('algebraicContent').style.display = 'none';
            document.getElementById('graphicalContent').style.display = 'none';
            updateConsistencyGraph();
        });
        
        // Algebraic method calculations
        document.getElementById('calculateAlgebraic').addEventListener('click', function() {
            const a1 = parseFloat(document.getElementById('a1').value);
            const b1 = parseFloat(document.getElementById('b1').value);
            const c1 = parseFloat(document.getElementById('c1').value);
            const a2 = parseFloat(document.getElementById('a2').value);
            const b2 = parseFloat(document.getElementById('b2').value);
            const c2 = parseFloat(document.getElementById('c2').value);
            const method = document.getElementById('method').value;
            
            // Check if system is consistent
            const determinant = a1 * b2 - a2 * b1;
            
            if (determinant === 0) {
                // Check if the system is consistent or inconsistent
                if (a1/a2 === b1/b2 && a1/a2 === c1/c2) {
                    document.getElementById('solution').textContent = "The system has infinitely many solutions (dependent equations).";
                    document.getElementById('algebraicSteps').innerHTML = "The determinant is 0 and the ratios of coefficients are equal, so the equations represent the same line.";
                } else {
                    document.getElementById('solution').textContent = "No solution exists (inconsistent system).";
                    document.getElementById('algebraicSteps').innerHTML = "The determinant is 0 but the ratios of coefficients are not equal, so the equations represent parallel lines.";
                }
            } else {
                // The system has a unique solution
                let x, y;
                let steps = "";
                
                if (method === "substitution") {
                    // Substitution Method
                    steps += "<h4>Substitution Method:</h4>";
                    
                    // Step 1: Solve for y from the first equation
                    if (b1 !== 0) {
                        steps += `<p>Step 1: Solve for y from the first equation: ${a1}x + ${b1}y = ${c1}</p>`;
                        steps += `<p>Subtract ${a1}x from both sides: ${b1}y = ${c1} - ${a1}x</p>`;
                        steps += `<p>Divide both sides by ${b1}: y = (${c1} - ${a1}x) / ${b1}</p>`;
                        
                        // Step 2: Substitute y into the second equation
                        steps += `<p>Step 2: Substitute y into the second equation: ${a2}x + ${b2}y = ${c2}</p>`;
                        steps += `<p>${a2}x + ${b2} × ((${c1} - ${a1}x) / ${b1}) = ${c2}</p>`;
                        
                        // Step 3: Solve for x
                        const factor = b2 / b1;
                        steps += `<p>Step 3: Simplify and solve for x:</p>`;
                        steps += `<p>${a2}x + ${b2} × (${c1}/${b1} - ${a1}/${b1}x) = ${c2}</p>`;
                        steps += `<p>${a2}x + ${b2*c1/b1} - ${b2*a1/b1}x = ${c2}</p>`;
                        steps += `<p>${a2 - b2*a1/b1}x = ${c2} - ${b2*c1/b1}</p>`;
                        
                        const coefficient = a2 - (b2 * a1 / b1);
                        const constant = c2 - (b2 * c1 / b1);
                        x = constant / coefficient;
                        steps += `<p>${coefficient}x = ${constant}</p>`;
                        steps += `<p>x = ${x.toFixed(4)}</p>`;
                        
                        // Step 4: Substitute x back to find y
                        y = (c1 - a1 * x) / b1;
                        steps += `<p>Step 4: Substitute x back to find y:</p>`;
                        steps += `<p>y = (${c1} - ${a1} × ${x.toFixed(4)}) / ${b1}</p>`;
                        steps += `<p>y = ${y.toFixed(4)}</p>`;
                    } else {
                        // If b1 = 0, solve for x from the first equation and proceed
                        steps += `<p>Step 1: Solve for x from the first equation (since b₁ = 0): ${a1}x = ${c1}</p>`;
                        x = c1 / a1;
                        steps += `<p>x = ${c1} / ${a1} = ${x.toFixed(4)}</p>`;
                        
                        steps += `<p>Step 2: Substitute x into the second equation: ${a2}x + ${b2}y = ${c2}</p>`;
                        steps += `<p>${a2} × ${x.toFixed(4)} + ${b2}y = ${c2}</p>`;
                        steps += `<p>${b2}y = ${c2} - ${a2 * x.toFixed(4)}</p>`;
                        y = (c2 - a2 * x) / b2;
                        steps += `<p>y = ${y.toFixed(4)}</p>`;
                    }
                } else {
                    // Elimination Method
                    steps += "<h4>Elimination Method:</h4>";
                    
                    // Decide which variable to eliminate
                    if (a1 !== 0 && a2 !== 0) {
                        // Eliminate x
                        const factor1 = a2;
                        const factor2 = a1;
                        
                        steps += `<p>Step 1: Multiply the first equation by ${factor1} and the second by ${factor2} to eliminate x:</p>`;
                        steps += `<p>(${a1}x + ${b1}y = ${c1}) × ${factor1} gives: ${a1*factor1}x + ${b1*factor1}y = ${c1*factor1}</p>`;
                        steps += `<p>(${a2}x + ${b2}y = ${c2}) × ${factor2} gives: ${a2*factor2}x + ${b2*factor2}y = ${c2*factor2}</p>`;
                        
                        steps += `<p>Step 2: Subtract the second equation from the first:</p>`;
                        const newB = b1 * factor1 - b2 * factor2;
                        const newC = c1 * factor1 - c2 * factor2;
                        
                        steps += `<p>(${a1*factor1}x + ${b1*factor1}y) - (${a2*factor2}x + ${b2*factor2}y) = ${c1*factor1} - ${c2*factor2}</p>`;
                        steps += `<p>${newB}y = ${newC}</p>`;
                        
                        y = newC / newB;
                        steps += `<p>y = ${newC} / ${newB} = ${y.toFixed(4)}</p>`;
                        
                        // Substitute y back to find x
                        steps += `<p>Step 3: Substitute y back into the first equation to find x:</p>`;
                        steps += `<p>${a1}x + ${b1} × ${y.toFixed(4)} = ${c1}</p>`;
                        steps += `<p>${a1}x = ${c1} - ${b1 * y.toFixed(4)}</p>`;
                        x = (c1 - b1 * y) / a1;
                        steps += `<p>x = ${x.toFixed(4)}</p>`;
                    } else if (b1 !== 0 && b2 !== 0) {
                        // Eliminate y
                        const factor1 = b2;
                        const factor2 = b1;
                        
                        steps += `<p>Step 1: Multiply the first equation by ${factor1} and the second by ${factor2} to eliminate y:</p>`;
                        steps += `<p>(${a1}x + ${b1}y = ${c1}) × ${factor1} gives: ${a1*factor1}x + ${b1*factor1}y = ${c1*factor1}</p>`;
                        steps += `<p>(${a2}x + ${b2}y = ${c2}) × ${factor2} gives: ${a2*factor2}x + ${b2*factor2}y = ${c2*factor2}</p>`;
                        
                        steps += `<p>Step 2: Subtract the second equation from the first:</p>`;
                        const newA = a1 * factor1 - a2 * factor2;
                        const newC = c1 * factor1 - c2 * factor2;
                        
                        steps += `<p>(${a1*factor1}x + ${b1*factor1}y) - (${a2*factor2}x + ${b2*factor2}y) = ${c1*factor1} - ${c2*factor2}</p>`;
                        steps += `<p>${newA}x = ${newC}</p>`;
                        
                        x = newC / newA;
                        steps += `<p>x = ${newC} / ${newA} = ${x.toFixed(4)}</p>`;
                        
                        // Substitute x back to find y
                        steps += `<p>Step 3: Substitute x back into the first equation to find y:</p>`;
                        steps += `<p>${a1} × ${x.toFixed(4)} + ${b1}y = ${c1}</p>`;
                        steps += `<p>${b1}y = ${c1} - ${a1 * x.toFixed(4)}</p>`;
                        y = (c1 - a1 * x) / b1;
                        steps += `<p>y = ${y.toFixed(4)}</p>`;
                    }
                }
                
                document.getElementById('solution').textContent = `Solution: x = ${x.toFixed(4)}, y = ${y.toFixed(4)}`;
                document.getElementById('algebraicSteps').innerHTML = steps;
            }
            
            document.getElementById('algebraicResult').style.display = 'block';
        });
        
        // Toggle steps visibility for algebraic methods
        document.getElementById('toggleAlgebraicSteps').addEventListener('click', function() {
            const steps = document.getElementById('algebraicSteps');
            if (steps.style.display === 'block') {
                steps.style.display = 'none';
                this.textContent = 'Show Steps';
            } else {
                steps.style.display = 'block';
                this.textContent = 'Hide Steps';
            }
        });
        
        // Graphical method calculations
        document.getElementById('calculateGraphical').addEventListener('click', function() {
            updateGraph();
        });
        
        function updateGraph() {
            const a1 = parseFloat(document.getElementById('g_a1').value);
            const b1 = parseFloat(document.getElementById('g_b1').value);
            const c1 = parseFloat(document.getElementById('g_c1').value);
            const a2 = parseFloat(document.getElementById('g_a2').value);
            const b2 = parseFloat(document.getElementById('g_b2').value);
            const c2 = parseFloat(document.getElementById('g_c2').value);
            
            // Check if inputs are valid
            if (isNaN(a1) || isNaN(b1) || isNaN(c1) || isNaN(a2) || isNaN(b2) || isNaN(c2)) {
                return;
            }
            
            // Find intersection (if exists)
            const determinant = a1 * b2 - a2 * b1;
            let x, y;
            let solutionText = "";
            
            if (determinant === 0) {
                // Check if lines are coincident or parallel
                if (a1/a2 === b1/b2 && a1/a2 === c1/c2) {
                    solutionText = "The system has infinitely many solutions. The lines coincide.";
                } else {
                    solutionText = "No solution exists. The lines are parallel.";
                }
            } else {
                // Unique solution exists
                x = (c1 * b2 - c2 * b1) / determinant;
                y = (a1 * c2 - a2 * c1) / determinant;
                solutionText = `Solution: x = ${x.toFixed(4)}, y = ${y.toFixed(4)}`;
            }
            
            document.getElementById('graphSolution').textContent = solutionText;
            document.getElementById('graphicalResult').style.display = 'block';
            
            // Draw the graph
            drawGraph(a1, b1, c1, a2, b2, c2, determinant !== 0 ? x : null, determinant !== 0 ? y : null);
        }
        
        function drawGraph(a1, b1, c1, a2, b2, c2, intersectX, intersectY) {
            const svg = document.getElementById('graph');
            svg.innerHTML = ''; // Clear existing content
            
            const width = svg.clientWidth;
            const height = svg.clientHeight;
            
            // Find appropriate range for x and y
            // For simplicity, we'll use a fixed range
            let minX = -10;
            let maxX = 10;
            let minY = -10;
            let maxY = 10;
            
            // If intersection exists, make sure it's in view
            if (intersectX !== null && intersectY !== null) {
                minX = Math.min(minX, intersectX - 5);
                maxX = Math.max(maxX, intersectX + 5);
                minY = Math.min(minY, intersectY - 5);
                maxY = Math.max(maxY, intersectY + 5);
            }
            
            // Scaling factors
            const scaleX = width / (maxX - minX);
            const scaleY = height / (maxY - minY);
            
            // Transform coordinates to SVG space
            function transformX(x) {
                return (x - minX) * scaleX;
            }
            
            function transformY(y) {
                return height - (y - minY) * scaleY; // Invert Y axis
            }
            
            // Draw grid
            const gridStep = 1;
            
            // Vertical grid lines
            for (let x = Math.ceil(minX); x <= Math.floor(maxX); x += gridStep) {
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", transformX(x));
                line.setAttribute("y1", 0);
                line.setAttribute("x2", transformX(x));
                line.setAttribute("y2", height);
                line.setAttribute("class", "grid-line");
                svg.appendChild(line);
                
                // X-axis labels
                if (x !== 0 && x % 2 === 0) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", transformX(x));
                    text.setAttribute("y", transformY(0) + 15);
                    text.setAttribute("text-anchor", "middle");
                    text.setAttribute("class", "axis-label");
                    text.textContent = x;
                    svg.appendChild(text);
                }
            }
            
            // Horizontal grid lines
            for (let y = Math.ceil(minY); y <= Math.floor(maxY); y += gridStep) {
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", 0);
                line.setAttribute("y1", transformY(y));
                line.setAttribute("x2", width);
                line.setAttribute("y2", transformY(y));
                line.setAttribute("class", "grid-line");
                svg.appendChild(line);
                
                // Y-axis labels
                if (y !== 0 && y % 2 === 0) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", transformX(0) - 10);
                    text.setAttribute("y", transformY(y) + 5);
                    text.setAttribute("text-anchor", "end");
                    text.setAttribute("class", "axis-label");
                    text.textContent = y;
                    svg.appendChild(text);
                }
            }
            
            // Draw x and y axes
            const xAxis = document.createElementNS("http://www.w3.org/2000/svg", "line");
            xAxis.setAttribute("x1", 0);
            xAxis.setAttribute("y1", transformY(0));
            xAxis.setAttribute("x2", width);
            xAxis.setAttribute("y2", transformY(0));
            xAxis.setAttribute("class", "axis-line");
            svg.appendChild(xAxis);
            
            const yAxis = document.createElementNS("http://www.w3.org/2000/svg", "line");
            yAxis.setAttribute("x1", transformX(0));
            yAxis.setAttribute("y1", 0);
            yAxis.setAttribute("x2", transformX(0));
            yAxis.setAttribute("y2", height);
            yAxis.setAttribute("class", "axis-line");
            svg.appendChild(yAxis);
            
            // Draw origin label
            const originLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
            originLabel.setAttribute("x", transformX(0) - 5);
            originLabel.setAttribute("y", transformY(0) + 15);
            originLabel.setAttribute("class", "axis-label");
            originLabel.textContent = "0";
            svg.appendChild(originLabel);
            
            // Draw the first line: a1*x + b1*y = c1
            // Calculate two points on the line
            let x1_1, y1_1, x1_2, y1_2;
            
            if (b1 !== 0) {
                // Calculate y for x = minX and x = maxX
                x1_1 = minX;
                y1_1 = (c1 - a1 * minX) / b1;
                x1_2 = maxX;
                y1_2 = (c1 - a1 * maxX) / b1;
            } else if (a1 !== 0) {
                // Vertical line: x = c1/a1
                x1_1 = c1 / a1;
                y1_1 = minY;
                x1_2 = c1 / a1;
                y1_2 = maxY;
            } else {
                // Invalid line (both a1 and b1 are 0)
                x1_1 = minX;
                y1_1 = 0;
                x1_2 = maxX;
                y1_2 = 0;
            }
            
            const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line1.setAttribute("x1", transformX(x1_1));
            line1.setAttribute("y1", transformY(y1_1));
            line1.setAttribute("x2", transformX(x1_2));
            line1.setAttribute("y2", transformY(y1_2));
            line1.setAttribute("class", "line1");
            svg.appendChild(line1);
            
            // Draw the second line: a2*x + b2*y = c2
            let x2_1, y2_1, x2_2, y2_2;
            
            if (b2 !== 0) {
                // Calculate y for x = minX and x = maxX
                x2_1 = minX;
                y2_1 = (c2 - a2 * minX) / b2;
                x2_2 = maxX;
                y2_2 = (c2 - a2 * maxX) / b2;
            } else if (a2 !== 0) {
                // Vertical line: x = c2/a2
                x2_1 = c2 / a2;
                y2_1 = minY;
                x2_2 = c2 / a2;
                y2_2 = maxY;
            } else {
                // Invalid line (both a2 and b2 are 0)
                x2_1 = minX;
                y2_1 = 0;
                x2_2 = maxX;
                y2_2 = 0;
            }
            
            const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line2.setAttribute("x1", transformX(x2_1));
            line2.setAttribute("y1", transformY(y2_1));
            line2.setAttribute("x2", transformX(x2_2));
            line2.setAttribute("y2", transformY(y2_2));
            line2.setAttribute("class", "line2");
            svg.appendChild(line2);
            
            // Line labels
            const text1 = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text1.setAttribute("x", transformX(maxX) - 40);
            text1.setAttribute("y", transformY(y1_2) - 10);
            text1.setAttribute("fill", "#ff6b6b");
            text1.setAttribute("font-weight", "bold");
            text1.textContent = "Line 1";
            svg.appendChild(text1);
            
            const text2 = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text2.setAttribute("x", transformX(maxX) - 40);
            text2.setAttribute("y", transformY(y2_2) + 20);
            text2.setAttribute("fill", "#4ecdc4");
            text2.setAttribute("font-weight", "bold");
            text2.textContent = "Line 2";
            svg.appendChild(text2);
            
            // Draw intersection point if it exists
            if (intersectX !== null && intersectY !== null) {
                const intersection = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                intersection.setAttribute("cx", transformX(intersectX));
                intersection.setAttribute("cy", transformY(intersectY));
                intersection.setAttribute("r", 5);
                intersection.setAttribute("class", "intersection");
                svg.appendChild(intersection);
                
                // Intersection label
                const intersectionLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
                intersectionLabel.setAttribute("x", transformX(intersectX) + 10);
                intersectionLabel.setAttribute("y", transformY(intersectY) - 10);
                intersectionLabel.setAttribute("fill", "#4a7aff");
                intersectionLabel.setAttribute("font-weight", "bold");
                intersectionLabel.textContent = `(${intersectX.toFixed(2)}, ${intersectY.toFixed(2)})`;
                svg.appendChild(intersectionLabel);
            }
        }
        
        // Consistency check functionality
        document.getElementById('checkConsistency').addEventListener('click', function() {
            const a1 = parseFloat(document.getElementById('c_a1').value);
            const b1 = parseFloat(document.getElementById('c_b1').value);
            const c1 = parseFloat(document.getElementById('c_c1').value);
            const a2 = parseFloat(document.getElementById('c_a2').value);
            const b2 = parseFloat(document.getElementById('c_b2').value);
            const c2 = parseFloat(document.getElementById('c_c2').value);
            
            // Calculate the determinant of the coefficient matrix
            const det = a1 * b2 - a2 * b1;
            
            // Calculate the rank of augmented matrix
            let rankOfCoeff, rankOfAug;
            
            // Check if any of the coefficients are zero
            let stepsHTML = "<h4>Analysis Steps:</h4>";
            stepsHTML += `<p>Step 1: Identify the system of equations.</p>`;
            stepsHTML += `<p>Equation 1: ${a1}x + ${b1}y = ${c1}</p>`;
            stepsHTML += `<p>Equation 2: ${a2}x + ${b2}y = ${c2}</p>`;
            
            stepsHTML += `<p>Step 2: Calculate the determinant of the coefficient matrix:</p>`;
            stepsHTML += `<p>|A| = |${a1} ${b1}| = ${a1} × ${b2} - ${a2} × ${b1} = ${det}</p>`;
            stepsHTML += `<p>      |${a2} ${b2}|</p>`;
            
            let statusHTML, ratioHTML;
            let consistencyClass = "";
            
            // Calculate ratios for analysis
            const ratioA = a2 / a1;
            const ratioB = b2 / b1;
            const ratioC = c2 / c1;
            
            if (det !== 0) {
                // Unique solution exists - system is consistent
                stepsHTML += `<p>Step 3: Since the determinant is not zero (${det}), the system has a unique solution.</p>`;
                stepsHTML += `<p>The system is <strong>consistent</strong> with exactly one solution.</p>`;
                
                // Calculate the solution
                const x = (c1 * b2 - c2 * b1) / det;
                const y = (a1 * c2 - a2 * c1) / det;
                stepsHTML += `<p>The solution is x = ${x.toFixed(4)}, y = ${y.toFixed(4)}</p>`;
                
                statusHTML = "Consistent System (Unique Solution)";
                consistencyClass = "consistent";
                
                ratioHTML = `<p>The system has a unique solution because the coefficient matrix has a non-zero determinant.</p>`;
            } else {
                // Determinant is zero, need to check the ratios
                stepsHTML += `<p>Step 3: The determinant is zero (${det}), so we need to check the ratios of coefficients.</p>`;
                
                stepsHTML += `<p>Calculating the ratios:</p>`;
                stepsHTML += `<p>a₂/a₁ = ${a2}/${a1} = ${ratioA.toFixed(4)}</p>`;
                stepsHTML += `<p>b₂/b₁ = ${b2}/${b1} = ${ratioB.toFixed(4)}</p>`;
                stepsHTML += `<p>c₂/c₁ = ${c2}/${c1} = ${ratioC.toFixed(4)}</p>`;
                
                // Create a ratio comparison table
                ratioHTML = `
                <h4>Ratio Analysis:</h4>
                <table>
                    <tr>
                        <th>Coefficients</th>
                        <th>Values</th>
                        <th>Ratio</th>
                    </tr>
                    <tr>
                        <td>a₂/a₁</td>
                        <td>${a2}/${a1}</td>
                        <td>${isNaN(ratioA) ? "undefined" : ratioA.toFixed(4)}</td>
                    </tr>
                    <tr>
                        <td>b₂/b₁</td>
                        <td>${b2}/${b1}</td>
                        <td>${isNaN(ratioB) ? "undefined" : ratioB.toFixed(4)}</td>
                    </tr>
                    <tr class="ratio-row">
                        <td>c₂/c₁</td>
                        <td>${c2}/${c1}</td>
                        <td>${isNaN(ratioC) ? "undefined" : ratioC.toFixed(4)}</td>
                    </tr>
                </table>`;
                
                // Check if the system is dependent or inconsistent
                const equalRatios = isNaN(ratioA) || isNaN(ratioB) || isNaN(ratioC) ? 
                    false : (Math.abs(ratioA - ratioB) < 0.0001 && Math.abs(ratioA - ratioC) < 0.0001);
                
                if (equalRatios) {
                    // Dependent equations - infinitely many solutions
                    stepsHTML += `<p>Step 4: The ratios a₂/a₁ = b₂/b₁ = c₂/c₁, so the equations are dependent.</p>`;
                    stepsHTML += `<p>The system is <strong>consistent</strong> with infinitely many solutions.</p>`;
                    stepsHTML += `<p>The second equation is ${ratioA.toFixed(4)} times the first equation.</p>`;
                    
                    statusHTML = "Consistent System (Infinitely Many Solutions)";
                    consistencyClass = "dependent";
                    
                    ratioHTML += `<p>Since all ratios are equal (${ratioA.toFixed(4)}), the equations are dependent and represent the same line.</p>`;
                } else {
                    // Inconsistent system - no solution
                    stepsHTML += `<p>Step 4: The ratios are not all equal, so the equations are inconsistent.</p>`;
                    stepsHTML += `<p>The system is <strong>inconsistent</strong> with no solution.</p>`;
                    
                    statusHTML = "Inconsistent System (No Solution)";
                    consistencyClass = "inconsistent";
                    
                    ratioHTML += `<p>Since the ratios are not all equal, the equations represent parallel lines with no intersection.</p>`;
                }
            }
            
            // Display results
            document.getElementById('consistencyStatus').textContent = statusHTML;
            document.getElementById('consistencyIndicator').className = `consistency-indicator ${consistencyClass}`;
            document.getElementById('ratioAnalysis').innerHTML = ratioHTML;
            document.getElementById('consistencySteps').innerHTML = stepsHTML;
            document.getElementById('consistencyResult').style.display = 'block';
            
            // Update the graph for consistency check
            updateConsistencyGraph();
        });
        
        // Toggle steps visibility for consistency check
        document.getElementById('toggleConsistencySteps').addEventListener('click', function() {
            const steps = document.getElementById('consistencySteps');
            if (steps.style.display === 'block') {
                steps.style.display = 'none';
                this.textContent = 'Show Steps';
            } else {
                steps.style.display = 'block';
                this.textContent = 'Hide Steps';
            }
        });
        
        function updateConsistencyGraph() {
            const a1 = parseFloat(document.getElementById('c_a1').value);
            const b1 = parseFloat(document.getElementById('c_b1').value);
            const c1 = parseFloat(document.getElementById('c_c1').value);
            const a2 = parseFloat(document.getElementById('c_a2').value);
            const b2 = parseFloat(document.getElementById('c_b2').value);
            const c2 = parseFloat(document.getElementById('c_c2').value);
            
            // Check if inputs are valid
            if (isNaN(a1) || isNaN(b1) || isNaN(c1) || isNaN(a2) || isNaN(b2) || isNaN(c2)) {
                return;
            }
            
            drawConsistencyGraph(a1, b1, c1, a2, b2, c2);
        }
        
        function drawConsistencyGraph(a1, b1, c1, a2, b2, c2) {
            const svg = document.getElementById('consistencyGraph');
            svg.innerHTML = ''; // Clear existing content
            
            const width = svg.clientWidth;
            const height = svg.clientHeight;
            
            // Find appropriate range for x and y
            // For simplicity, we'll use a fixed range
            let minX = -10;
            let maxX = 10;
            let minY = -10;
            let maxY = 10;
            
            // Calculate determinant to check for intersection
            const det = a1 * b2 - a2 * b1;
            let intersectX = null;
            let intersectY = null;
            
            if (det !== 0) {
                // Calculate intersection point
                intersectX = (c1 * b2 - c2 * b1) / det;
                intersectY = (a1 * c2 - a2 * c1) / det;
                
                // Adjust range to make sure intersection is visible
                minX = Math.min(minX, intersectX - 2);
                maxX = Math.max(maxX, intersectX + 2);
                minY = Math.min(minY, intersectY - 2);
                maxY = Math.max(maxY, intersectY + 2);
            }
            
            // Scaling factors
            const scaleX = width / (maxX - minX);
            const scaleY = height / (maxY - minY);
            
            // Transform coordinates to SVG space
            function transformX(x) {
                return (x - minX) * scaleX;
            }
            
            function transformY(y) {
                return height - (y - minY) * scaleY; // Invert Y axis
            }
            
            // Draw grid
            const gridStep = 1;
            
            // Vertical grid lines
            for (let x = Math.ceil(minX); x <= Math.floor(maxX); x += gridStep) {
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", transformX(x));
                line.setAttribute("y1", 0);
                line.setAttribute("x2", transformX(x));
                line.setAttribute("y2", height);
                line.setAttribute("class", "grid-line");
                svg.appendChild(line);
                
                // X-axis labels
                if (x !== 0 && x % 2 === 0) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", transformX(x));
                    text.setAttribute("y", transformY(0) + 15);
                    text.setAttribute("text-anchor", "middle");
                    text.setAttribute("class", "axis-label");
                    text.textContent = x;
                    svg.appendChild(text);
                }
            }
            
            // Horizontal grid lines
            for (let y = Math.ceil(minY); y <= Math.floor(maxY); y += gridStep) {
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", 0);
                line.setAttribute("y1", transformY(y));
                line.setAttribute("x2", width);
                line.setAttribute("y2", transformY(y));
                line.setAttribute("class", "grid-line");
                svg.appendChild(line);
                
                // Y-axis labels
                if (y !== 0 && y % 2 === 0) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", transformX(0) - 10);
                    text.setAttribute("y", transformY(y) + 5);
                    text.setAttribute("text-anchor", "end");
                    text.setAttribute("class", "axis-label");
                    text.textContent = y;
                    svg.appendChild(text);
                }
            }
            
            // Draw x and y axes
            const xAxis = document.createElementNS("http://www.w3.org/2000/svg", "line");
            xAxis.setAttribute("x1", 0);
            xAxis.setAttribute("y1", transformY(0));
            xAxis.setAttribute("x2", width);
            xAxis.setAttribute("y2", transformY(0));
            xAxis.setAttribute("class", "axis-line");
            svg.appendChild(xAxis);
            
            const yAxis = document.createElementNS("http://www.w3.org/2000/svg", "line");
            yAxis.setAttribute("x1", transformX(0));
            yAxis.setAttribute("y1", 0);
            yAxis.setAttribute("x2", transformX(0));
            yAxis.setAttribute("y2", height);
            yAxis.setAttribute("class", "axis-line");
            svg.appendChild(yAxis);
            
            // Draw origin label
            const originLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
            originLabel.setAttribute("x", transformX(0) - 5);
            originLabel.setAttribute("y", transformY(0) + 15);
            originLabel.setAttribute("class", "axis-label");
            originLabel.textContent = "0";
            svg.appendChild(originLabel);
            
            // Draw the first line: a1*x + b1*y = c1
            // Calculate two points on the line
            let x1_1, y1_1, x1_2, y1_2;
            
            if (b1 !== 0) {
                // Calculate y for x = minX and x = maxX
                x1_1 = minX;
                y1_1 = (c1 - a1 * minX) / b1;
                x1_2 = maxX;
                y1_2 = (c1 - a1 * maxX) / b1;
            } else if (a1 !== 0) {
                // Vertical line: x = c1/a1
                x1_1 = c1 / a1;
                y1_1 = minY;
                x1_2 = c1 / a1;
                y1_2 = maxY;
            } else {
                // Invalid line (both a1 and b1 are 0)
                x1_1 = minX;
                y1_1 = 0;
                x1_2 = maxX;
                y1_2 = 0;
            }
            
            const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line1.setAttribute("x1", transformX(x1_1));
            line1.setAttribute("y1", transformY(y1_1));
            line1.setAttribute("x2", transformX(x1_2));
            line1.setAttribute("y2", transformY(y1_2));
            line1.setAttribute("class", "line1");
            svg.appendChild(line1);
            
            // Draw the second line: a2*x + b2*y = c2
            let x2_1, y2_1, x2_2, y2_2;
            
            if (b2 !== 0) {
                // Calculate y for x = minX and x = maxX
                x2_1 = minX;
                y2_1 = (c2 - a2 * minX) / b2;
                x2_2 = maxX;
                y2_2 = (c2 - a2 * maxX) / b2;
            } else if (a2 !== 0) {
                // Vertical line: x = c2/a2
                x2_1 = c2 / a2;
                y2_1 = minY;
                x2_2 = c2 / a2;
                y2_2 = maxY;
            } else {
                // Invalid line (both a2 and b2 are 0)
                x2_1 = minX;
                y2_1 = 0;
                x2_2 = maxX;
                y2_2 = 0;
            }
            
            const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line2.setAttribute("x1", transformX(x2_1));
            line2.setAttribute("y1", transformY(y2_1));
            line2.setAttribute("x2", transformX(x2_2));
            line2.setAttribute("y2", transformY(y2_2));
            line2.setAttribute("class", "line2");
            svg.appendChild(line2);
            
            // Line labels
            const text1 = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text1.setAttribute("x", transformX(maxX) - 40);
            text1.setAttribute("y", transformY(y1_2) - 10);
            text1.setAttribute("fill", "#ff6b6b");
            text1.setAttribute("font-weight", "bold");
            text1.textContent = "Line 1";
            svg.appendChild(text1);
            
            const text2 = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text2.setAttribute("x", transformX(maxX) - 40);
            text2.setAttribute("y", transformY(y2_2) + 20);
            text2.setAttribute("fill", "#4ecdc4");
            text2.setAttribute("font-weight", "bold");
            text2.textContent = "Line 2";
            svg.appendChild(text2);
            
            // Draw intersection point if it exists
            if (intersectX !== null && intersectY !== null) {
                const intersection = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                intersection.setAttribute("cx", transformX(intersectX));
                intersection.setAttribute("cy", transformY(intersectY));
                intersection.setAttribute("r", 5);
                intersection.setAttribute("class", "intersection");
                svg.appendChild(intersection);
                
                // Intersection label
                const intersectionLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
                intersectionLabel.setAttribute("x", transformX(intersectX) + 10);
                intersectionLabel.setAttribute("y", transformY(intersectY) - 10);
                intersectionLabel.setAttribute("fill", "#4a7aff");
                intersectionLabel.setAttribute("font-weight", "bold");
                intersectionLabel.textContent = `(${intersectX.toFixed(2)}, ${intersectY.toFixed(2)})`;
                svg.appendChild(intersectionLabel);
            }
        }
    </script>
</body>
</html>